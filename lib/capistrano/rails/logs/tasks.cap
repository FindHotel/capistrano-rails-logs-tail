namespace :rails do
  desc "Tail rails logs from server"
  task :logs, :target_role do |t, args|
    SSHKit.config.output_verbosity = Logger::DEBUG
    args.with_defaults(target_role: :app)
    target_role = args[:target_role].to_sym
    puts "Tailing #{fetch(:rails_env)} logs on role (#{target_role})"
    on roles(target_role) do
      execute "tail -f #{current_path}/log/#{fetch(:rails_env)}.log"
    end
  end
end
